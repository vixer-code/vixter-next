(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[239],{4435:function(s,e,a){Promise.resolve().then(a.bind(a,9285))},9285:function(s,e,a){"use strict";a.r(e);var i=a(7437),l=a(2265),c=a(4033),t=a(2749),r=a(6691),n=a.n(r);a(9215);let d=(0,l.lazy)(()=>a.e(197).then(a.bind(a,4197))),o=(0,l.lazy)(()=>a.e(144).then(a.bind(a,1144)));e.default=()=>{var s,e,a,r,h;let u=(0,c.useParams)();(0,c.useRouter)();let{data:m}=(0,t.useSession)(),v=(null==u?void 0:null===(s=u.userId)||void 0===s?void 0:s[0])||(null==m?void 0:null===(e=m.user)||void 0===e?void 0:e.id),[p,j]=(0,l.useState)(null),[x,f]=(0,l.useState)(!0),[N,b]=(0,l.useState)(!1),[g,k]=(0,l.useState)(!1),[y,S]=(0,l.useState)("perfil"),[C,w]=(0,l.useState)([]),[P,E]=(0,l.useState)(!1),[F,A]=(0,l.useState)(!1),[D,O]=(0,l.useState)([]),[T,V]=(0,l.useState)(""),[U,I]=(0,l.useState)([]),[_,M]=(0,l.useState)([]),[L,R]=(0,l.useState)(!1),[q,z]=(0,l.useState)(!1),[H,J]=(0,l.useState)(null),[B,G]=(0,l.useState)(!1),[K,Q]=(0,l.useState)(null),[W,X]=(0,l.useState)([]),[Y,Z]=(0,l.useState)([]),[$,ss]=(0,l.useState)(!1),[se,sa]=(0,l.useState)(!1),[si,sl]=(0,l.useState)(!1),[sc,st]=(0,l.useState)(null),[sr,sn]=(0,l.useState)(0),[sd,so]=(0,l.useState)(0),[sh,su]=(0,l.useState)([]),[sm,sv]=(0,l.useState)([]),[sp,sj]=(0,l.useState)([]),[sx,sf]=(0,l.useState)(""),sN=!v||(null==m?void 0:null===(a=m.user)||void 0===a?void 0:a.id)===v,sb=(null==p?void 0:null===(r=p.user)||void 0===r?void 0:r.verified)||!1;(0,l.useEffect)(()=>{v&&sg()},[v]),(0,l.useEffect)(()=>{"perfil"===y&&p&&sk()},[y,p]),(0,l.useEffect)(()=>{"servicos"===y&&p&&sy()},[y,p]),(0,l.useEffect)(()=>{"packs"===y&&p&&sS()},[y,p]);let sg=async()=>{try{f(!0);let o=await fetch("/api/users/".concat(v));if(o.ok){var s,e,a,i,l,c,t,r,n,d;let h=await o.json(),u={id:(null===(s=h.profile)||void 0===s?void 0:s.id)||"",userId:h.id,bio:(null===(e=h.profile)||void 0===e?void 0:e.bio)||"",avatarUrl:(null===(a=h.profile)||void 0===a?void 0:a.avatarUrl)||"",interests:(null===(i=h.profile)||void 0===i?void 0:i.interests)||[],location:(null===(l=h.profile)||void 0===l?void 0:l.location)||"",languages:(null===(c=h.profile)||void 0===c?void 0:c.languages)||"",hobbies:(null===(t=h.profile)||void 0===t?void 0:t.hobbies)||"",aboutMe:(null===(r=h.profile)||void 0===r?void 0:r.aboutMe)||"",createdAt:(null===(n=h.profile)||void 0===n?void 0:n.createdAt)||h.createdAt,updatedAt:(null===(d=h.profile)||void 0===d?void 0:d.updatedAt)||h.updatedAt,user:{id:h.id,name:h.name,username:h.username||"",email:h.email,verified:h.verified||!1,createdAt:h.createdAt}};j(u)}}catch(s){console.error("Error loading profile:",s)}finally{f(!1)}},sk=async()=>{try{let s=await fetch("/api/users/".concat(v,"/posts"));if(s.ok){let e=await s.json();O(e)}}catch(s){console.error("Error loading posts:",s)}},sy=async()=>{try{ss(!0);let s=await fetch("/api/users/".concat(v,"/services"));if(s.ok){let e=await s.json();X(e)}}catch(s){console.error("Error loading services:",s)}finally{ss(!1)}},sS=async()=>{try{sa(!0);let s=await fetch("/api/users/".concat(v,"/packs"));if(s.ok){let e=await s.json();Z(e)}}catch(s){console.error("Error loading packs:",s)}finally{sa(!1)}},sC=async(s,e)=>{var a;let i=null===(a=s.target.files)||void 0===a?void 0:a[0];if(i&&(null==m?void 0:m.user))try{k(!0);let s=new FormData;s.append("file",i),s.append("type",e);let a=await fetch("/api/media/upload",{method:"POST",body:s});if(a.ok){let s=await a.json();await sw({["avatar"===e?"avatarUrl":"coverPhotoURL"]:s.url})}}catch(s){console.error("Error uploading image:",s)}finally{k(!1)}},sw=async s=>{try{var e;let a=await fetch("/api/users/".concat(null==m?void 0:null===(e=m.user)||void 0===e?void 0:e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(a.ok){let s=await a.json();return j(s),!0}}catch(s){console.error("Error updating profile:",s)}return!1},sP=async()=>{if((null==m?void 0:m.user)&&p)try{(await fetch("/api/users/".concat(p.userId,"/follow"),{method:P?"DELETE":"POST"})).ok&&E(!P)}catch(s){console.error("Error following/unfollowing:",s)}},sE=async()=>{if(T.trim()&&(null==m?void 0:m.user))try{let s=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:T,hashtags:sF(T)})});if(s.ok){let e=await s.json();O([e,...D]),V(""),I([])}}catch(s){console.error("Error creating post:",s)}},sF=s=>s.match(/#[\w\u00C0-\u017F]+/g)||[],sA=s=>s&&(s.name||s.username)||"Usu\xe1rio",sD=s=>{var e;return(null==s?void 0:null===(e=s.profile)||void 0===e?void 0:e.avatarUrl)||(null==s?void 0:s.image)||"/images/defpfp1.png"},sO=(0,l.useCallback)(s=>{let e=s.currentTarget.dataset.tab;e&&e!==y&&S(e)},[y]),sT=(0,l.useCallback)(async()=>{(null==m?void 0:m.user)&&sN&&sb&&(sl(!0),st(null),console.log("\uD83D\uDEA7 Dashboard de vendas ser\xe1 carregado do backend em breve!"),sj([]),su([]),sv([]),sn(0),so(0),sl(!1))},[null==m?void 0:m.user,sN,sb]);return((0,l.useEffect)(()=>{"sales"===y&&sT()},[y,sT]),x)?(0,i.jsx)("div",{className:"profile-container",children:(0,i.jsx)("div",{className:"loading-text",children:"Carregando..."})}):p?(0,i.jsxs)("div",{className:"profile-container",children:[(0,i.jsxs)("div",{className:"profile-header",children:[(0,i.jsxs)("div",{className:"cover-photo",children:[(0,i.jsx)(n(),{src:"/images/homeImage2.png",alt:"Cover",fill:!0,style:{objectFit:"cover"}}),sN&&(0,i.jsxs)("div",{className:"cover-upload",children:[(0,i.jsx)("input",{type:"file",id:"cover-upload",accept:"image/*",onChange:s=>sC(s,"cover"),style:{display:"none"}}),(0,i.jsx)("label",{htmlFor:"cover-upload",className:"upload-btn",children:(0,i.jsx)("i",{className:"fas fa-camera"})})]})]}),(0,i.jsxs)("div",{className:"profile-info",children:[(0,i.jsx)("div",{className:"avatar-section",children:(0,i.jsxs)("div",{className:"avatar-container",children:[(0,i.jsx)(n(),{src:sD(p),alt:sA(p.user),width:120,height:120,className:"avatar"}),sN&&(0,i.jsxs)("div",{className:"avatar-upload",children:[(0,i.jsx)("input",{type:"file",id:"avatar-upload",accept:"image/*",onChange:s=>sC(s,"avatar"),style:{display:"none"}}),(0,i.jsx)("label",{htmlFor:"avatar-upload",className:"upload-btn",children:(0,i.jsx)("i",{className:"fas fa-camera"})})]})]})}),(0,i.jsxs)("div",{className:"user-details",children:[(0,i.jsx)("h1",{children:sA(null==p?void 0:p.user)}),(null==p?void 0:null===(h=p.user)||void 0===h?void 0:h.username)&&(0,i.jsxs)("p",{className:"username",children:["@",p.user.username]}),(null==p?void 0:p.bio)&&(0,i.jsx)("p",{className:"bio",children:p.bio}),(0,i.jsxs)("div",{className:"profile-stats",children:[(0,i.jsxs)("div",{className:"stat",children:[(0,i.jsx)("span",{className:"stat-number",children:D.length}),(0,i.jsx)("span",{className:"stat-label",children:"Posts"})]}),(0,i.jsxs)("div",{className:"stat",children:[(0,i.jsx)("span",{className:"stat-number",children:C.length}),(0,i.jsx)("span",{className:"stat-label",children:"Seguidores"})]}),(0,i.jsxs)("div",{className:"stat",children:[(0,i.jsx)("span",{className:"stat-number",children:W.length}),(0,i.jsx)("span",{className:"stat-label",children:"Servi\xe7os"})]})]}),(0,i.jsx)("div",{className:"profile-actions",children:sN?(0,i.jsxs)("button",{className:"btn-primary",onClick:()=>b(!0),children:[(0,i.jsx)("i",{className:"fas fa-edit"}),"Editar Perfil"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("button",{className:"btn-follow ".concat(P?"following":""),onClick:sP,children:[(0,i.jsx)("i",{className:"fas ".concat(P?"fa-user-check":"fa-user-plus")}),P?"Seguindo":"Seguir"]}),(0,i.jsxs)("button",{className:"btn-secondary",children:[(0,i.jsx)("i",{className:"fas fa-envelope"}),"Mensagem"]})]})})]})]})]}),(0,i.jsxs)("div",{className:"profile-nav",children:[(0,i.jsxs)("button",{className:"nav-tab ".concat("perfil"===y?"active":""),"data-tab":"perfil",onClick:sO,children:[(0,i.jsx)("i",{className:"fas fa-user"}),"Perfil"]}),(0,i.jsxs)("button",{className:"nav-tab ".concat("servicos"===y?"active":""),"data-tab":"servicos",onClick:sO,children:[(0,i.jsx)("i",{className:"fas fa-briefcase"}),"Servi\xe7os"]}),(0,i.jsxs)("button",{className:"nav-tab ".concat("packs"===y?"active":""),"data-tab":"packs",onClick:sO,children:[(0,i.jsx)("i",{className:"fas fa-box"}),"Packs"]}),sN&&sb&&(0,i.jsxs)("button",{className:"nav-tab ".concat("sales"===y?"active":""),"data-tab":"sales",onClick:sO,children:[(0,i.jsx)("i",{className:"fas fa-chart-line"}),"Vendas"]})]}),(0,i.jsxs)("div",{className:"profile-content",children:["perfil"===y&&(0,i.jsxs)("div",{className:"profile-tab",children:[sN&&(0,i.jsxs)("div",{className:"create-post",children:[(0,i.jsx)("div",{className:"post-input",children:(0,i.jsx)("textarea",{value:T,onChange:s=>V(s.target.value),placeholder:"O que voc\xea est\xe1 pensando?",rows:3})}),(0,i.jsxs)("div",{className:"post-actions",children:[(0,i.jsxs)("button",{className:"btn-secondary",children:[(0,i.jsx)("i",{className:"fas fa-image"}),"Foto"]}),(0,i.jsx)("button",{className:"btn-primary",onClick:sE,disabled:!T.trim(),children:"Publicar"})]})]}),(0,i.jsx)("div",{className:"posts-list",children:0===D.length?(0,i.jsxs)("div",{className:"no-posts",children:[(0,i.jsx)("i",{className:"fas fa-comments"}),(0,i.jsx)("p",{children:"Nenhuma publica\xe7\xe3o ainda"})]}):D.map(s=>(0,i.jsxs)("div",{className:"post-card",children:[(0,i.jsxs)("div",{className:"post-header",children:[(0,i.jsxs)("div",{className:"post-author",children:[(0,i.jsx)(n(),{src:sD(s.user),alt:sA(s.user),width:40,height:40,className:"author-avatar"}),(0,i.jsxs)("div",{className:"author-info",children:[(0,i.jsx)("h4",{children:sA(s.user)}),(0,i.jsx)("span",{className:"post-date",children:new Date(s.createdAt).toLocaleDateString("pt-BR")})]})]}),sN&&(0,i.jsx)("button",{className:"post-menu",children:(0,i.jsx)("i",{className:"fas fa-ellipsis-h"})})]}),(0,i.jsxs)("div",{className:"post-content",children:[(0,i.jsx)("p",{children:s.content}),s.media&&(0,i.jsx)("div",{className:"post-media",children:(0,i.jsx)(n(),{src:s.media.url,alt:"Post media",width:500,height:300,style:{objectFit:"cover"}})})]}),(0,i.jsxs)("div",{className:"post-actions",children:[(0,i.jsxs)("button",{className:"action-btn",children:[(0,i.jsx)("i",{className:"fas fa-heart"}),s.likes.length]}),(0,i.jsxs)("button",{className:"action-btn",children:[(0,i.jsx)("i",{className:"fas fa-comment"}),"Comentar"]}),(0,i.jsxs)("button",{className:"action-btn",children:[(0,i.jsx)("i",{className:"fas fa-share"}),"Compartilhar"]})]})]},s.id))})]}),"servicos"===y&&(0,i.jsxs)("div",{className:"services-tab",children:[sN&&(0,i.jsxs)("div",{className:"tab-header",children:[(0,i.jsx)("h3",{children:"Meus Servi\xe7os"}),(0,i.jsxs)("button",{className:"btn-primary",onClick:()=>z(!0),children:[(0,i.jsx)("i",{className:"fas fa-plus"}),"Criar Servi\xe7o"]})]}),(0,i.jsx)("div",{className:"services-grid",children:$?(0,i.jsx)("div",{className:"loading-text",children:"Carregando servi\xe7os..."}):0===W.length?(0,i.jsxs)("div",{className:"no-services",children:[(0,i.jsx)("i",{className:"fas fa-briefcase"}),(0,i.jsx)("p",{children:"Nenhum servi\xe7o encontrado"}),sN&&(0,i.jsx)("button",{className:"btn-primary",onClick:()=>z(!0),children:"Criar Primeiro Servi\xe7o"})]}):W.map(s=>(0,i.jsxs)("div",{className:"service-card",children:[(0,i.jsx)("div",{className:"service-image",children:(0,i.jsx)(n(),{src:s.coverImageURL||"/images/defpfp1.png",alt:s.title,width:300,height:200,style:{objectFit:"cover"}})}),(0,i.jsxs)("div",{className:"service-info",children:[(0,i.jsx)("h4",{children:s.title}),(0,i.jsx)("p",{className:"service-description",children:s.description}),(0,i.jsxs)("div",{className:"service-price",children:["A partir de ",(1.5*s.price).toFixed(2).replace(".",",")," VP"]}),(0,i.jsx)("div",{className:"service-tags",children:s.tags.slice(0,3).map((s,e)=>(0,i.jsx)("span",{className:"tag",children:s},e))})]}),sN&&(0,i.jsxs)("div",{className:"service-actions",children:[(0,i.jsx)("button",{className:"btn-secondary",onClick:()=>{J(s),z(!0)},children:(0,i.jsx)("i",{className:"fas fa-edit"})}),(0,i.jsx)("button",{className:"btn-danger",children:(0,i.jsx)("i",{className:"fas fa-trash"})})]})]},s.id))})]}),"packs"===y&&(0,i.jsxs)("div",{className:"packs-tab",children:[sN&&(0,i.jsxs)("div",{className:"tab-header",children:[(0,i.jsx)("h3",{children:"Meus Packs"}),(0,i.jsxs)("button",{className:"btn-primary",onClick:()=>G(!0),children:[(0,i.jsx)("i",{className:"fas fa-plus"}),"Criar Pack"]})]}),(0,i.jsx)("div",{className:"packs-grid",children:se?(0,i.jsx)("div",{className:"loading-text",children:"Carregando packs..."}):0===Y.length?(0,i.jsxs)("div",{className:"no-packs",children:[(0,i.jsx)("i",{className:"fas fa-box"}),(0,i.jsx)("p",{children:"Nenhum pack encontrado"}),sN&&(0,i.jsx)("button",{className:"btn-primary",onClick:()=>G(!0),children:"Criar Primeiro Pack"})]}):Y.map(s=>(0,i.jsxs)("div",{className:"pack-card",children:[(0,i.jsxs)("div",{className:"pack-image",children:[(0,i.jsx)(n(),{src:s.coverImage||"/images/defpfp1.png",alt:s.title,width:300,height:200,style:{objectFit:"cover"}}),s.discount>0&&(0,i.jsxs)("div",{className:"discount-badge",children:["-",s.discount,"%"]})]}),(0,i.jsxs)("div",{className:"pack-info",children:[(0,i.jsx)("h4",{children:s.title}),(0,i.jsx)("p",{className:"pack-description",children:s.description}),(0,i.jsx)("div",{className:"pack-price",children:s.discount>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{className:"original-price",children:[(1.5*s.price).toFixed(2).replace(".",",")," VP"]}),(0,i.jsxs)("span",{className:"discounted-price",children:[(s.price*(1-s.discount/100)*1.5).toFixed(2).replace(".",",")," VP"]})]}):(0,i.jsxs)("span",{className:"price",children:[(1.5*s.price).toFixed(2).replace(".",",")," VP"]})}),(0,i.jsx)("div",{className:"pack-tags",children:s.tags.slice(0,3).map((s,e)=>(0,i.jsx)("span",{className:"tag",children:s},e))})]}),sN&&(0,i.jsxs)("div",{className:"pack-actions",children:[(0,i.jsx)("button",{className:"btn-secondary",onClick:()=>{Q(s),G(!0)},children:(0,i.jsx)("i",{className:"fas fa-edit"})}),(0,i.jsx)("button",{className:"btn-danger",children:(0,i.jsx)("i",{className:"fas fa-trash"})})]})]},s.id))})]}),"sales"===y&&sN&&sb&&(0,i.jsx)("div",{className:"sales-tab",children:(0,i.jsxs)("div",{className:"sales-dashboard",children:[(0,i.jsx)("h3",{children:"Dashboard de Vendas"}),si?(0,i.jsx)("div",{className:"loading-text",children:"Carregando dados de vendas..."}):(0,i.jsxs)("div",{className:"sales-content",children:[(0,i.jsxs)("div",{className:"sales-stats",children:[(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("div",{className:"stat-icon",children:(0,i.jsx)("i",{className:"fas fa-coins"})}),(0,i.jsxs)("div",{className:"stat-info",children:[(0,i.jsx)("h4",{children:"Total Ganho"}),(0,i.jsxs)("p",{children:[sr.toFixed(2)," VC"]})]})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("div",{className:"stat-icon",children:(0,i.jsx)("i",{className:"fas fa-shopping-cart"})}),(0,i.jsxs)("div",{className:"stat-info",children:[(0,i.jsx)("h4",{children:"Total de Vendas"}),(0,i.jsx)("p",{children:sd})]})]})]}),(0,i.jsxs)("div",{className:"sales-info",children:[(0,i.jsx)("p",{children:"\uD83D\uDEA7 Dashboard de vendas completo ser\xe1 implementado em breve!"}),(0,i.jsx)("p",{children:"Aqui voc\xea poder\xe1 ver:"}),(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"Hist\xf3rico detalhado de vendas"}),(0,i.jsx)("li",{children:"Produtos mais vendidos"}),(0,i.jsx)("li",{children:"Compradores frequentes"}),(0,i.jsx)("li",{children:"An\xe1lise de performance"})]})]})]})]})})]}),q&&(0,i.jsx)(l.Suspense,{fallback:(0,i.jsx)("div",{children:"Carregando..."}),children:(0,i.jsx)(d,{isOpen:q,onClose:()=>{z(!1),J(null)},onServiceCreated:()=>{sy(),z(!1),J(null)},editingService:H})}),B&&(0,i.jsx)(l.Suspense,{fallback:(0,i.jsx)("div",{children:"Carregando..."}),children:(0,i.jsx)(o,{isOpen:B,onClose:()=>{G(!1),Q(null)},onPackCreated:()=>{sS(),G(!1),Q(null)},editingPack:K})})]}):(0,i.jsx)("div",{className:"profile-container",children:(0,i.jsx)("div",{className:"error-message",children:"Perfil n\xe3o encontrado"})})}},9215:function(){}},function(s){s.O(0,[232,691,971,938,744],function(){return s(s.s=4435)}),_N_E=s.O()}]);