(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[239],{4435:function(s,e,a){Promise.resolve().then(a.bind(a,9285))},9285:function(s,e,a){"use strict";a.r(e);var i=a(7437),l=a(2265),c=a(4033),t=a(2749),r=a(6691),n=a.n(r);a(9215);let d=(0,l.lazy)(()=>a.e(197).then(a.bind(a,4197))),o=(0,l.lazy)(()=>a.e(144).then(a.bind(a,1144)));e.default=()=>{var s,e,a,r;let h=(0,c.useParams)();(0,c.useRouter)();let{data:m}=(0,t.useSession)(),u=(null==h?void 0:null===(s=h.userId)||void 0===s?void 0:s[0])||(null==m?void 0:null===(e=m.user)||void 0===e?void 0:e.id),[j,x]=(0,l.useState)(null),[p,v]=(0,l.useState)(!0),[f,N]=(0,l.useState)(!1),[b,g]=(0,l.useState)(!1),[k,y]=(0,l.useState)("perfil"),[S,C]=(0,l.useState)([]),[w,P]=(0,l.useState)(!1),[E,F]=(0,l.useState)(!1),[D,O]=(0,l.useState)([]),[T,V]=(0,l.useState)(""),[A,_]=(0,l.useState)([]),[I,U]=(0,l.useState)([]),[L,R]=(0,l.useState)(!1),[q,M]=(0,l.useState)(!1),[z,H]=(0,l.useState)(null),[J,B]=(0,l.useState)(!1),[G,K]=(0,l.useState)(null),[Q,W]=(0,l.useState)([]),[X,Y]=(0,l.useState)([]),[Z,$]=(0,l.useState)(!1),[ss,se]=(0,l.useState)(!1),[sa,si]=(0,l.useState)(!1),[sl,sc]=(0,l.useState)(null),[st,sr]=(0,l.useState)(0),[sn,sd]=(0,l.useState)(0),[so,sh]=(0,l.useState)([]),[sm,su]=(0,l.useState)([]),[sj,sx]=(0,l.useState)([]),[sp,sv]=(0,l.useState)(""),sf=!u||(null==m?void 0:null===(a=m.user)||void 0===a?void 0:a.id)===u,sN=(null==j?void 0:null===(r=j.user)||void 0===r?void 0:r.verified)||!1;(0,l.useEffect)(()=>{u&&sb()},[u]),(0,l.useEffect)(()=>{"perfil"===k&&j&&sg()},[k,j]),(0,l.useEffect)(()=>{"servicos"===k&&j&&sk()},[k,j]),(0,l.useEffect)(()=>{"packs"===k&&j&&sy()},[k,j]);let sb=async()=>{try{v(!0);let s=await fetch("/api/users/".concat(u));if(s.ok){let e=await s.json();x(e)}}catch(s){console.error("Error loading profile:",s)}finally{v(!1)}},sg=async()=>{try{let s=await fetch("/api/users/".concat(u,"/posts"));if(s.ok){let e=await s.json();O(e)}}catch(s){console.error("Error loading posts:",s)}},sk=async()=>{try{$(!0);let s=await fetch("/api/users/".concat(u,"/services"));if(s.ok){let e=await s.json();W(e)}}catch(s){console.error("Error loading services:",s)}finally{$(!1)}},sy=async()=>{try{se(!0);let s=await fetch("/api/users/".concat(u,"/packs"));if(s.ok){let e=await s.json();Y(e)}}catch(s){console.error("Error loading packs:",s)}finally{se(!1)}},sS=async(s,e)=>{var a;let i=null===(a=s.target.files)||void 0===a?void 0:a[0];if(i&&(null==m?void 0:m.user))try{g(!0);let s=new FormData;s.append("file",i),s.append("type",e);let a=await fetch("/api/media/upload",{method:"POST",body:s});if(a.ok){let s=await a.json();await sC({["avatar"===e?"avatarUrl":"coverPhotoURL"]:s.url})}}catch(s){console.error("Error uploading image:",s)}finally{g(!1)}},sC=async s=>{try{var e;let a=await fetch("/api/users/".concat(null==m?void 0:null===(e=m.user)||void 0===e?void 0:e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(a.ok){let s=await a.json();return x(s),!0}}catch(s){console.error("Error updating profile:",s)}return!1},sw=async()=>{if((null==m?void 0:m.user)&&j)try{(await fetch("/api/users/".concat(j.userId,"/follow"),{method:w?"DELETE":"POST"})).ok&&P(!w)}catch(s){console.error("Error following/unfollowing:",s)}},sP=async()=>{if(T.trim()&&(null==m?void 0:m.user))try{let s=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:T,hashtags:sE(T)})});if(s.ok){let e=await s.json();O([e,...D]),V(""),_([])}}catch(s){console.error("Error creating post:",s)}},sE=s=>s.match(/#[\w\u00C0-\u017F]+/g)||[],sF=s=>(null==s?void 0:s.name)||(null==s?void 0:s.username)||"Usu\xe1rio",sD=s=>{var e;return(null==s?void 0:null===(e=s.profile)||void 0===e?void 0:e.avatarUrl)||(null==s?void 0:s.image)||"/images/defpfp1.png"},sO=(0,l.useCallback)(s=>{let e=s.currentTarget.dataset.tab;e&&e!==k&&y(e)},[k]),sT=(0,l.useCallback)(async()=>{(null==m?void 0:m.user)&&sf&&sN&&(si(!0),sc(null),console.log("\uD83D\uDEA7 Dashboard de vendas ser\xe1 carregado do backend em breve!"),sx([]),sh([]),su([]),sr(0),sd(0),si(!1))},[null==m?void 0:m.user,sf,sN]);return((0,l.useEffect)(()=>{"sales"===k&&sT()},[k,sT]),p)?(0,i.jsx)("div",{className:"profile-container",children:(0,i.jsx)("div",{className:"loading-text",children:"Carregando..."})}):j?(0,i.jsxs)("div",{className:"profile-container",children:[(0,i.jsxs)("div",{className:"profile-header",children:[(0,i.jsxs)("div",{className:"cover-photo",children:[(0,i.jsx)(n(),{src:"/images/homeImage2.png",alt:"Cover",fill:!0,style:{objectFit:"cover"}}),sf&&(0,i.jsxs)("div",{className:"cover-upload",children:[(0,i.jsx)("input",{type:"file",id:"cover-upload",accept:"image/*",onChange:s=>sS(s,"cover"),style:{display:"none"}}),(0,i.jsx)("label",{htmlFor:"cover-upload",className:"upload-btn",children:(0,i.jsx)("i",{className:"fas fa-camera"})})]})]}),(0,i.jsxs)("div",{className:"profile-info",children:[(0,i.jsx)("div",{className:"avatar-section",children:(0,i.jsxs)("div",{className:"avatar-container",children:[(0,i.jsx)(n(),{src:sD(j),alt:sF(j.user),width:120,height:120,className:"avatar"}),sf&&(0,i.jsxs)("div",{className:"avatar-upload",children:[(0,i.jsx)("input",{type:"file",id:"avatar-upload",accept:"image/*",onChange:s=>sS(s,"avatar"),style:{display:"none"}}),(0,i.jsx)("label",{htmlFor:"avatar-upload",className:"upload-btn",children:(0,i.jsx)("i",{className:"fas fa-camera"})})]})]})}),(0,i.jsxs)("div",{className:"user-details",children:[(0,i.jsx)("h1",{children:sF(j.user)}),j.user.username&&(0,i.jsxs)("p",{className:"username",children:["@",j.user.username]}),j.bio&&(0,i.jsx)("p",{className:"bio",children:j.bio}),(0,i.jsxs)("div",{className:"profile-stats",children:[(0,i.jsxs)("div",{className:"stat",children:[(0,i.jsx)("span",{className:"stat-number",children:D.length}),(0,i.jsx)("span",{className:"stat-label",children:"Posts"})]}),(0,i.jsxs)("div",{className:"stat",children:[(0,i.jsx)("span",{className:"stat-number",children:S.length}),(0,i.jsx)("span",{className:"stat-label",children:"Seguidores"})]}),(0,i.jsxs)("div",{className:"stat",children:[(0,i.jsx)("span",{className:"stat-number",children:Q.length}),(0,i.jsx)("span",{className:"stat-label",children:"Servi\xe7os"})]})]}),(0,i.jsx)("div",{className:"profile-actions",children:sf?(0,i.jsxs)("button",{className:"btn-primary",onClick:()=>N(!0),children:[(0,i.jsx)("i",{className:"fas fa-edit"}),"Editar Perfil"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("button",{className:"btn-follow ".concat(w?"following":""),onClick:sw,children:[(0,i.jsx)("i",{className:"fas ".concat(w?"fa-user-check":"fa-user-plus")}),w?"Seguindo":"Seguir"]}),(0,i.jsxs)("button",{className:"btn-secondary",children:[(0,i.jsx)("i",{className:"fas fa-envelope"}),"Mensagem"]})]})})]})]})]}),(0,i.jsxs)("div",{className:"profile-nav",children:[(0,i.jsxs)("button",{className:"nav-tab ".concat("perfil"===k?"active":""),"data-tab":"perfil",onClick:sO,children:[(0,i.jsx)("i",{className:"fas fa-user"}),"Perfil"]}),(0,i.jsxs)("button",{className:"nav-tab ".concat("servicos"===k?"active":""),"data-tab":"servicos",onClick:sO,children:[(0,i.jsx)("i",{className:"fas fa-briefcase"}),"Servi\xe7os"]}),(0,i.jsxs)("button",{className:"nav-tab ".concat("packs"===k?"active":""),"data-tab":"packs",onClick:sO,children:[(0,i.jsx)("i",{className:"fas fa-box"}),"Packs"]}),sf&&sN&&(0,i.jsxs)("button",{className:"nav-tab ".concat("sales"===k?"active":""),"data-tab":"sales",onClick:sO,children:[(0,i.jsx)("i",{className:"fas fa-chart-line"}),"Vendas"]})]}),(0,i.jsxs)("div",{className:"profile-content",children:["perfil"===k&&(0,i.jsxs)("div",{className:"profile-tab",children:[sf&&(0,i.jsxs)("div",{className:"create-post",children:[(0,i.jsx)("div",{className:"post-input",children:(0,i.jsx)("textarea",{value:T,onChange:s=>V(s.target.value),placeholder:"O que voc\xea est\xe1 pensando?",rows:3})}),(0,i.jsxs)("div",{className:"post-actions",children:[(0,i.jsxs)("button",{className:"btn-secondary",children:[(0,i.jsx)("i",{className:"fas fa-image"}),"Foto"]}),(0,i.jsx)("button",{className:"btn-primary",onClick:sP,disabled:!T.trim(),children:"Publicar"})]})]}),(0,i.jsx)("div",{className:"posts-list",children:0===D.length?(0,i.jsxs)("div",{className:"no-posts",children:[(0,i.jsx)("i",{className:"fas fa-comments"}),(0,i.jsx)("p",{children:"Nenhuma publica\xe7\xe3o ainda"})]}):D.map(s=>(0,i.jsxs)("div",{className:"post-card",children:[(0,i.jsxs)("div",{className:"post-header",children:[(0,i.jsxs)("div",{className:"post-author",children:[(0,i.jsx)(n(),{src:sD(s.user),alt:sF(s.user),width:40,height:40,className:"author-avatar"}),(0,i.jsxs)("div",{className:"author-info",children:[(0,i.jsx)("h4",{children:sF(s.user)}),(0,i.jsx)("span",{className:"post-date",children:new Date(s.createdAt).toLocaleDateString("pt-BR")})]})]}),sf&&(0,i.jsx)("button",{className:"post-menu",children:(0,i.jsx)("i",{className:"fas fa-ellipsis-h"})})]}),(0,i.jsxs)("div",{className:"post-content",children:[(0,i.jsx)("p",{children:s.content}),s.media&&(0,i.jsx)("div",{className:"post-media",children:(0,i.jsx)(n(),{src:s.media.url,alt:"Post media",width:500,height:300,style:{objectFit:"cover"}})})]}),(0,i.jsxs)("div",{className:"post-actions",children:[(0,i.jsxs)("button",{className:"action-btn",children:[(0,i.jsx)("i",{className:"fas fa-heart"}),s.likes.length]}),(0,i.jsxs)("button",{className:"action-btn",children:[(0,i.jsx)("i",{className:"fas fa-comment"}),"Comentar"]}),(0,i.jsxs)("button",{className:"action-btn",children:[(0,i.jsx)("i",{className:"fas fa-share"}),"Compartilhar"]})]})]},s.id))})]}),"servicos"===k&&(0,i.jsxs)("div",{className:"services-tab",children:[sf&&(0,i.jsxs)("div",{className:"tab-header",children:[(0,i.jsx)("h3",{children:"Meus Servi\xe7os"}),(0,i.jsxs)("button",{className:"btn-primary",onClick:()=>M(!0),children:[(0,i.jsx)("i",{className:"fas fa-plus"}),"Criar Servi\xe7o"]})]}),(0,i.jsx)("div",{className:"services-grid",children:Z?(0,i.jsx)("div",{className:"loading-text",children:"Carregando servi\xe7os..."}):0===Q.length?(0,i.jsxs)("div",{className:"no-services",children:[(0,i.jsx)("i",{className:"fas fa-briefcase"}),(0,i.jsx)("p",{children:"Nenhum servi\xe7o encontrado"}),sf&&(0,i.jsx)("button",{className:"btn-primary",onClick:()=>M(!0),children:"Criar Primeiro Servi\xe7o"})]}):Q.map(s=>(0,i.jsxs)("div",{className:"service-card",children:[(0,i.jsx)("div",{className:"service-image",children:(0,i.jsx)(n(),{src:s.coverImageURL||"/images/defpfp1.png",alt:s.title,width:300,height:200,style:{objectFit:"cover"}})}),(0,i.jsxs)("div",{className:"service-info",children:[(0,i.jsx)("h4",{children:s.title}),(0,i.jsx)("p",{className:"service-description",children:s.description}),(0,i.jsxs)("div",{className:"service-price",children:["A partir de ",(1.5*s.price).toFixed(2).replace(".",",")," VP"]}),(0,i.jsx)("div",{className:"service-tags",children:s.tags.slice(0,3).map((s,e)=>(0,i.jsx)("span",{className:"tag",children:s},e))})]}),sf&&(0,i.jsxs)("div",{className:"service-actions",children:[(0,i.jsx)("button",{className:"btn-secondary",onClick:()=>{H(s),M(!0)},children:(0,i.jsx)("i",{className:"fas fa-edit"})}),(0,i.jsx)("button",{className:"btn-danger",children:(0,i.jsx)("i",{className:"fas fa-trash"})})]})]},s.id))})]}),"packs"===k&&(0,i.jsxs)("div",{className:"packs-tab",children:[sf&&(0,i.jsxs)("div",{className:"tab-header",children:[(0,i.jsx)("h3",{children:"Meus Packs"}),(0,i.jsxs)("button",{className:"btn-primary",onClick:()=>B(!0),children:[(0,i.jsx)("i",{className:"fas fa-plus"}),"Criar Pack"]})]}),(0,i.jsx)("div",{className:"packs-grid",children:ss?(0,i.jsx)("div",{className:"loading-text",children:"Carregando packs..."}):0===X.length?(0,i.jsxs)("div",{className:"no-packs",children:[(0,i.jsx)("i",{className:"fas fa-box"}),(0,i.jsx)("p",{children:"Nenhum pack encontrado"}),sf&&(0,i.jsx)("button",{className:"btn-primary",onClick:()=>B(!0),children:"Criar Primeiro Pack"})]}):X.map(s=>(0,i.jsxs)("div",{className:"pack-card",children:[(0,i.jsxs)("div",{className:"pack-image",children:[(0,i.jsx)(n(),{src:s.coverImage||"/images/defpfp1.png",alt:s.title,width:300,height:200,style:{objectFit:"cover"}}),s.discount>0&&(0,i.jsxs)("div",{className:"discount-badge",children:["-",s.discount,"%"]})]}),(0,i.jsxs)("div",{className:"pack-info",children:[(0,i.jsx)("h4",{children:s.title}),(0,i.jsx)("p",{className:"pack-description",children:s.description}),(0,i.jsx)("div",{className:"pack-price",children:s.discount>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{className:"original-price",children:[(1.5*s.price).toFixed(2).replace(".",",")," VP"]}),(0,i.jsxs)("span",{className:"discounted-price",children:[(s.price*(1-s.discount/100)*1.5).toFixed(2).replace(".",",")," VP"]})]}):(0,i.jsxs)("span",{className:"price",children:[(1.5*s.price).toFixed(2).replace(".",",")," VP"]})}),(0,i.jsx)("div",{className:"pack-tags",children:s.tags.slice(0,3).map((s,e)=>(0,i.jsx)("span",{className:"tag",children:s},e))})]}),sf&&(0,i.jsxs)("div",{className:"pack-actions",children:[(0,i.jsx)("button",{className:"btn-secondary",onClick:()=>{K(s),B(!0)},children:(0,i.jsx)("i",{className:"fas fa-edit"})}),(0,i.jsx)("button",{className:"btn-danger",children:(0,i.jsx)("i",{className:"fas fa-trash"})})]})]},s.id))})]}),"sales"===k&&sf&&sN&&(0,i.jsx)("div",{className:"sales-tab",children:(0,i.jsxs)("div",{className:"sales-dashboard",children:[(0,i.jsx)("h3",{children:"Dashboard de Vendas"}),sa?(0,i.jsx)("div",{className:"loading-text",children:"Carregando dados de vendas..."}):(0,i.jsxs)("div",{className:"sales-content",children:[(0,i.jsxs)("div",{className:"sales-stats",children:[(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("div",{className:"stat-icon",children:(0,i.jsx)("i",{className:"fas fa-coins"})}),(0,i.jsxs)("div",{className:"stat-info",children:[(0,i.jsx)("h4",{children:"Total Ganho"}),(0,i.jsxs)("p",{children:[st.toFixed(2)," VC"]})]})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("div",{className:"stat-icon",children:(0,i.jsx)("i",{className:"fas fa-shopping-cart"})}),(0,i.jsxs)("div",{className:"stat-info",children:[(0,i.jsx)("h4",{children:"Total de Vendas"}),(0,i.jsx)("p",{children:sn})]})]})]}),(0,i.jsxs)("div",{className:"sales-info",children:[(0,i.jsx)("p",{children:"\uD83D\uDEA7 Dashboard de vendas completo ser\xe1 implementado em breve!"}),(0,i.jsx)("p",{children:"Aqui voc\xea poder\xe1 ver:"}),(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"Hist\xf3rico detalhado de vendas"}),(0,i.jsx)("li",{children:"Produtos mais vendidos"}),(0,i.jsx)("li",{children:"Compradores frequentes"}),(0,i.jsx)("li",{children:"An\xe1lise de performance"})]})]})]})]})})]}),q&&(0,i.jsx)(l.Suspense,{fallback:(0,i.jsx)("div",{children:"Carregando..."}),children:(0,i.jsx)(d,{isOpen:q,onClose:()=>{M(!1),H(null)},onServiceCreated:()=>{sk(),M(!1),H(null)},editingService:z})}),J&&(0,i.jsx)(l.Suspense,{fallback:(0,i.jsx)("div",{children:"Carregando..."}),children:(0,i.jsx)(o,{isOpen:J,onClose:()=>{B(!1),K(null)},onPackCreated:()=>{sy(),B(!1),K(null)},editingPack:G})})]}):(0,i.jsx)("div",{className:"profile-container",children:(0,i.jsx)("div",{className:"error-message",children:"Perfil n\xe3o encontrado"})})}},9215:function(){}},function(s){s.O(0,[232,691,971,938,744],function(){return s(s.s=4435)}),_N_E=s.O()}]);